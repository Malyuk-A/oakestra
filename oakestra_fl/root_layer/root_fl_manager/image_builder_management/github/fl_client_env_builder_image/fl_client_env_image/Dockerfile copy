FROM docker.io/continuumio/miniconda3:24.1.2-0
LABEL org.opencontainers.image.source https://github.com/oakestra/oakestra

COPY fl_env fl_env
WORKDIR /fl_env

RUN conda env update --file ./conda.yaml &&\
    # https://flower.dev/docs/framework/how-to-install-flower.html
    conda config --add channels conda-forge &&\
    conda config --set channel_priority strict &&\
    conda install flwr -y &&\
    conda clean -tipy
SHELL ["conda", "run", "-n", "base", "/bin/bash", "-c"]

# https://flower.dev/docs/framework/ref-telemetry.html
ENV FLWR_TELEMETRY_ENABLED=0

